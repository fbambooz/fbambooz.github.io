<!doctype html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="centos6.5,openstack,icehouse,云计算,linux," />





  <link rel="alternate" href="/atom.xml" title="F.C.Y" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/images/little_panda.jpg?v=5.1.1" />






<meta name="description" content="之前因为需要在CentOS6.5上面安装了OpenStack的Icehouse版本，这里对安装过程进行记录。我这里是选择了OpenStack最基础的结构也就是一个控制节点controller和一个计算节点compute进行搭建，如下图所示。 环境 &amp;amp; 版本安装镜像：CentOS-6.5-x86_64-bin-DVD1.isoOS：CentOS 6.5内核：2.6.32-431.el6.x8">
<meta name="keywords" content="centos6.5,openstack,icehouse,云计算,linux">
<meta property="og:type" content="article">
<meta property="og:title" content="Centos6.5安装OpenStack Icehouse版本">
<meta property="og:url" content="http://fbambooz.com/2017/06/25/Centos6.5安装OpenStack Icehouse版本/index.html">
<meta property="og:site_name" content="F.C.Y">
<meta property="og:description" content="之前因为需要在CentOS6.5上面安装了OpenStack的Icehouse版本，这里对安装过程进行记录。我这里是选择了OpenStack最基础的结构也就是一个控制节点controller和一个计算节点compute进行搭建，如下图所示。 环境 &amp;amp; 版本安装镜像：CentOS-6.5-x86_64-bin-DVD1.isoOS：CentOS 6.5内核：2.6.32-431.el6.x8">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/nova-network_architecture.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/Centos65YumConf.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/startnetwork.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/Centos65Host.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/add_in_mysql_conf.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/user-list.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/user-role-list.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/glance_image_list.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/nova-image-list.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/openstack_login_website.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/start_hardware_acceleration.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/nova_net-list.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/nova-keypair-list.png">
<meta property="og:image" content="http://or8rxwtgb.bkt.clouddn.com/libgmp_warning.png">
<meta property="og:updated_time" content="2017-07-18T08:16:18.385Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Centos6.5安装OpenStack Icehouse版本">
<meta name="twitter:description" content="之前因为需要在CentOS6.5上面安装了OpenStack的Icehouse版本，这里对安装过程进行记录。我这里是选择了OpenStack最基础的结构也就是一个控制节点controller和一个计算节点compute进行搭建，如下图所示。 环境 &amp;amp; 版本安装镜像：CentOS-6.5-x86_64-bin-DVD1.isoOS：CentOS 6.5内核：2.6.32-431.el6.x8">
<meta name="twitter:image" content="http://or8rxwtgb.bkt.clouddn.com/nova-network_architecture.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://fbambooz.com/2017/06/25/Centos6.5安装OpenStack Icehouse版本/"/>





  <title>Centos6.5安装OpenStack Icehouse版本 | F.C.Y</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-100634120-1', 'auto');
  ga('send', 'pageview');
</script>












  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">F.C.Y</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://fbambooz.com/2017/06/25/Centos6.5安装OpenStack Icehouse版本/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fbambooz">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/little_panda.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="F.C.Y">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Centos6.5安装OpenStack Icehouse版本</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-25T18:10:05+08:00">
                2017-06-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/06/25/Centos6.5安装OpenStack Icehouse版本/" class="leancloud_visitors" data-flag-title="Centos6.5安装OpenStack Icehouse版本">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>之前因为需要在CentOS6.5上面安装了OpenStack的Icehouse版本，这里对安装过程进行记录。我这里是选择了OpenStack最基础的结构也就是一个控制节点<code>controller</code>和一个计算节点<code>compute</code>进行搭建，如下图所示。<br><img src="http://or8rxwtgb.bkt.clouddn.com/nova-network_architecture.png" alt="nova-network架构"></p>
<h1 id="环境-amp-版本"><a href="#环境-amp-版本" class="headerlink" title="环境 &amp; 版本"></a>环境 &amp; 版本</h1><p>安装镜像：CentOS-6.5-x86_64-bin-DVD1.iso<br>OS：CentOS 6.5<br>内核：2.6.32-431.el6.x86_64<br>OpenStack：Icehouse</p>
<hr>
<h1 id="安装前准备"><a href="#安装前准备" class="headerlink" title="安装前准备"></a>安装前准备</h1><p>以下步骤需要在 <code>controller</code> 和 <code>compute</code> 节点上都进行操作。</p>
<h2 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># service iptables stop</div><div class="line"># chkconfig iptables off</div></pre></td></tr></table></figure>
<h2 id="修改文件"><a href="#修改文件" class="headerlink" title="修改文件"></a>修改文件</h2><h3 id="修改-etc-yum-conf文件"><a href="#修改-etc-yum-conf文件" class="headerlink" title="修改/etc/yum.conf文件"></a>修改/etc/yum.conf文件</h3><p>在/etc/yum.conf文件中[main]下添加如下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">exclude=kernel*</div><div class="line">exclude=centos-release*</div></pre></td></tr></table></figure></p>
<p><img src="http://or8rxwtgb.bkt.clouddn.com/Centos65YumConf.png" alt="修改/etc/yum.conf文件"><br>（因为我当时需要在centos6.5版本中安装，如果不是，可以忽略此步）</p>
<h3 id="配置网络"><a href="#配置网络" class="headerlink" title="配置网络"></a>配置网络</h3><p>这里 <code>controller</code>节点只需要一个网卡<code>eth0</code>用来跟 <code>compute</code>节点通信，而 <code>compute</code>节点需要两个网卡<code>eth0</code>和<code>eth1</code>，其中<code>eth0</code>用来与 <code>controller</code>通信，而 <code>eth1</code>用来与外部网络通信。</p>
<p>编辑/etc/sysconfig/network-scripts/ifcfg-eth0文件，启动网络。因为默认centos6.5安装好网络默认关闭。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">···</div><div class="line">ONBOOT=yes</div><div class="line">BOOTPROTO=dhcp</div><div class="line">···</div></pre></td></tr></table></figure></p>
<p><img src="http://or8rxwtgb.bkt.clouddn.com/startnetwork.png" alt="startnetwork"></p>
<p>此外， <code>compute</code>节点上需要修改 <code>eth1</code>，编辑/etc/sysconfig/network-scripts/ifcfg-eth1文件，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">···</div><div class="line">ONBOOT=yes</div><div class="line">BOOTPROTO=none</div><div class="line">···</div></pre></td></tr></table></figure></p>
<p>修改完后，重启网络服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># service network restart</div><div class="line"># ifconfig</div></pre></td></tr></table></figure></p>
<p>记录下eth0的ip地址，根据ip地址修改/etc/hosts文件，添加 <code>controller</code> 和 <code>compute</code>节点的ip。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</div><div class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</div><div class="line"></div><div class="line">192.168.159.#controller</div><div class="line">192.168.159.#compute</div></pre></td></tr></table></figure></p>
<p><img src="http://or8rxwtgb.bkt.clouddn.com/Centos65Host.png" alt="修改hosts文件"></p>
<h2 id="添加IceHouse源"><a href="#添加IceHouse源" class="headerlink" title="添加IceHouse源"></a>添加IceHouse源</h2><p>安装yum-plugin-priority插件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># yum install yum-plugin-priorities</div></pre></td></tr></table></figure></p>
<p>在/etc/yum.repos.d/目录下新建 <code>rdo-release.repo</code>文件，并将如下内容写入该文件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[openstack-icehouse]</div><div class="line">name=OpenStack Icehouse Repository</div><div class="line">baseurl=http://repos.fedorapeople.org/repos/openstack/EOL/openstack-icehouse/epel-6/</div><div class="line">enabled=1</div><div class="line">skip_if_unavailable=0</div><div class="line">gpgcheck=0</div><div class="line">#gpgkey=file:///etc/pki/rpm-gpg/RPM_GPG_KEY_RDO_Icehouse</div><div class="line">priority=98</div></pre></td></tr></table></figure></p>
<p>安装最新的epel-release包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># yum install http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</div></pre></td></tr></table></figure></p>
<p>安装openstakc-utils包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># yum install openstack-utils</div></pre></td></tr></table></figure></p>
<p>安装openstack-selinux包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># yum install openstack-selinux</div></pre></td></tr></table></figure></p>
<p>安装完成后upgrade<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># yum upgrade</div></pre></td></tr></table></figure></p>
<h2 id="安装消息队列qpid"><a href="#安装消息队列qpid" class="headerlink" title="安装消息队列qpid"></a>安装消息队列qpid</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># yum install qpid-cpp-server</div></pre></td></tr></table></figure>
<h3 id="配置qpid"><a href="#配置qpid" class="headerlink" title="配置qpid"></a>配置qpid</h3><p>编辑/etc/qpidd.conf文件，将字段 <code>auth</code>设置为no<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">···</div><div class="line">auth=no</div></pre></td></tr></table></figure></p>
<h3 id="启动qpid并设置开机启动"><a href="#启动qpid并设置开机启动" class="headerlink" title="启动qpid并设置开机启动"></a>启动qpid并设置开机启动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># service qpidd start</div><div class="line"># chkconfig qpidd on</div></pre></td></tr></table></figure>
<hr>
<h1 id="控制节点controller配置"><a href="#控制节点controller配置" class="headerlink" title="控制节点controller配置"></a>控制节点controller配置</h1><h2 id="安装MySQL数据库"><a href="#安装MySQL数据库" class="headerlink" title="安装MySQL数据库"></a>安装MySQL数据库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># yum install mysql mysql-server MySQL-python</div></pre></td></tr></table></figure>
<h3 id="修改数据库配置"><a href="#修改数据库配置" class="headerlink" title="修改数据库配置"></a>修改数据库配置</h3><p>编辑/etc/my.cnf文档，在[mysqld]下加入如下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[mysqld]</div><div class="line">bind-address = controller</div><div class="line">default-storage-engine = innodb</div><div class="line">innodb_file_per_table</div><div class="line">collation-server = utf8_general_ci</div><div class="line">init-connect = &apos;SET NAMES utf8&apos;</div><div class="line">character-set-server = utf8</div></pre></td></tr></table></figure></p>
<p><img src="http://or8rxwtgb.bkt.clouddn.com/add_in_mysql_conf.png" alt="修改my.cnf文件"></p>
<h3 id="启动mysql并设置开机启动"><a href="#启动mysql并设置开机启动" class="headerlink" title="启动mysql并设置开机启动"></a>启动mysql并设置开机启动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># service mysqld start</div><div class="line"># chkconfig mysqld on</div></pre></td></tr></table></figure>
<h3 id="初始化数据库"><a href="#初始化数据库" class="headerlink" title="初始化数据库"></a>初始化数据库</h3><p>初始化数据库，根据自己需要设置相应参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># mysql_install_db</div><div class="line"># mysql_secure_installation</div></pre></td></tr></table></figure></p>
<h2 id="安装配置身份认证组件keystone"><a href="#安装配置身份认证组件keystone" class="headerlink" title="安装配置身份认证组件keystone"></a>安装配置身份认证组件keystone</h2><h3 id="安装keystone"><a href="#安装keystone" class="headerlink" title="安装keystone"></a>安装keystone</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># yum install openstack-keystone python-keystoneclient</div></pre></td></tr></table></figure>
<h3 id="配置keystone"><a href="#配置keystone" class="headerlink" title="配置keystone"></a>配置keystone</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"># openstack-config --set /etc/keystone/keystone.conf database connection mysql://keystone:passwd@controller/keystone</div><div class="line"></div><div class="line"># mysql -uroot -p</div><div class="line">mysql&gt; CREATE DATABASE keystone;</div><div class="line">mysql&gt; GRANT ALL PRIVILEGES ON keystone.* TO &apos;keystone&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;password&apos;;</div><div class="line">mysql&gt; GRANT ALL PRIVILEGES ON keystone.* TO &apos;keystone&apos;@&apos;%&apos; IDENTIFIED BY &apos;password’;</div><div class="line">mysql&gt; exit</div><div class="line"></div><div class="line"># su -s /bin/sh -c &quot;keystone-manage db_sync&quot; keystone</div><div class="line"># mysql -uroot -p</div><div class="line"># ADMIN_TOKEN=$(openssl rand -hex 10)</div><div class="line"># echo $ADMIN_TOKEN</div><div class="line"># openstack-config --set /etc/keystone/keystone.conf DEFAULT admin_token $ADMIN_TOKEN</div><div class="line"># keystone-manage pki_setup --keystone-user keystone --keystone-group keystone</div><div class="line"># chown -R keystone:keystone /etc/keystone/ssl</div><div class="line"># chmod -R o-rwx /etc/keystone/ssl</div><div class="line"># service openstack-keystone start</div><div class="line"># service openstack-keystone on</div><div class="line"># chkconfig openstack-keystone on</div><div class="line"># (crontab -l -u keystone 2&gt;&amp;1 | grep -q token_flush) || echo &apos;@hourly /usr/bin/keystone-manage token_flush &gt;/var/log/keystone/keystone-tokenflush.log 2&gt;&amp;1&apos; &gt;&gt; /var/spool/cron/keystone</div></pre></td></tr></table></figure>
<h3 id="创建用户、租户、角色"><a href="#创建用户、租户、角色" class="headerlink" title="创建用户、租户、角色"></a>创建用户、租户、角色</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># export OS_SERVICE_TOKEN=$ADMIN_TOKEN</div><div class="line"># export OS_SERVICE_ENDPOINT=http://controller:35357/v2.0</div><div class="line"># keystone user-create --name=admin --pass=passwd --email=123456@qq.com</div><div class="line"># keystone role-create --name=admin</div><div class="line"># keystone tenant-create --name=admin --description=&quot;Admin Tenant&quot;</div><div class="line"># keystone user-role-add --user=admin --tenant=admin --role=admin</div><div class="line"># keystone user-role-add --user=admin --role_member_ --tenant=admin</div><div class="line"># keystone user-role-add --user=admin --role=_member_ --tenant=admin</div><div class="line"># keystone tenant-create --name=service --description=&quot;Service Tenant&quot;</div><div class="line"># keystone service-create --name=keystone --type=identity --description=&quot;OpenStack Identity&quot;</div><div class="line"># keystone endpoint-create --service-id=$(keystone service-list | awk &apos;/ identity / &#123;print $2&#125;&apos;) --publicurl=http://controller:5000/v2.0 --internalurl=http://controller:5000/v2.0 --adminurl=http://controller:35357/v2.0</div></pre></td></tr></table></figure>
<h3 id="验证keyston是否成功安装"><a href="#验证keyston是否成功安装" class="headerlink" title="验证keyston是否成功安装"></a>验证keyston是否成功安装</h3><h4 id="创建-admin-openrc-sh文件"><a href="#创建-admin-openrc-sh文件" class="headerlink" title="创建 admin-openrc.sh文件"></a>创建 <code>admin-openrc.sh</code>文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">export OS_USERNAME=admin</div><div class="line">export OS_PASSWORD=ADMIN_PASS</div><div class="line">export OS_TENANT_NAME=admin</div><div class="line">export OS_AUTH_URL=http://controller:35357/v2.0</div></pre></td></tr></table></figure>
<p>将上述变量添加到环境变量中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># source admin-openrc.sh</div></pre></td></tr></table></figure></p>
<h4 id="验证keystone"><a href="#验证keystone" class="headerlink" title="验证keystone"></a>验证keystone</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># keystone token-get</div></pre></td></tr></table></figure>
<p>这条命令将返回一个token和租户的ID，用来验证已经正确配置了环境变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># keystoen user-list</div></pre></td></tr></table></figure>
<p><img src="http://or8rxwtgb.bkt.clouddn.com/user-list.png" alt="user-list"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># keystone user-role-list --user admin --tenant admin</div></pre></td></tr></table></figure>
<p><img src="http://or8rxwtgb.bkt.clouddn.com/user-role-list.png" alt="user-role-list"></p>
<p>如果上述命令正常显示，说明keystone服务已正常安装</p>
<h2 id="安装和配置镜像组件glance"><a href="#安装和配置镜像组件glance" class="headerlink" title="安装和配置镜像组件glance"></a>安装和配置镜像组件glance</h2><h3 id="安装glance"><a href="#安装glance" class="headerlink" title="安装glance"></a>安装glance</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># yum install openstack-glance python-glanceclient</div></pre></td></tr></table></figure>
<h3 id="配置glance数据库"><a href="#配置glance数据库" class="headerlink" title="配置glance数据库"></a>配置glance数据库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"># openstack-config --set /etc/glance/glance-api.conf database connection mysql://glance:passwd@controller/glance</div><div class="line"># openstack-config --set /etc/glance/glance-registry.conf database connection mysql://glance:passwd@controller/glance</div><div class="line"></div><div class="line"># mysql -uroot -p</div><div class="line">mysql&gt; CREATE DATABASE glance;</div><div class="line">mysql&gt; GRANT ALL PRIVILEGES ON glance.* TO &apos;glance&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;password&apos;;</div><div class="line">mysql&gt; GRANT ALL PRIVILEGES ON glance.* TO &apos;glance&apos;@&apos;%&apos; IDENTIFIED BY &apos;password&apos;;</div><div class="line">mysql&gt;exit</div><div class="line"></div><div class="line"># su -s /bin/sh -c &quot;glance-manage db_sync&quot; glance</div></pre></td></tr></table></figure>
<h3 id="创建glance用户"><a href="#创建glance用户" class="headerlink" title="创建glance用户"></a>创建glance用户</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># keystone user-create --name=glance --pass=passwd --email=123456@qq.com</div><div class="line"># keystone user-role-add --user=glance --tenant=service --role=admin</div></pre></td></tr></table></figure>
<h3 id="配置glance"><a href="#配置glance" class="headerlink" title="配置glance"></a>配置glance</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"># openstack-config --set /etc/glance/glance-api.conf keystone_authtoken auth_uri http://controller:5000</div><div class="line"># openstack-config --set /etc/glance/glance-api.conf keystone_authtoken auth_host controller</div><div class="line"># openstack-config --set /etc/glance/glance-api.conf keystone_authtoken auth_port 35357</div><div class="line"># openstack-config --set /etc/glance/glance-api.conf keystone_authtoken auth_protocol http</div><div class="line"># openstack-config --set /etc/glance/glance-api.conf keystone_authtoken admin_tenant_name service</div><div class="line"># openstack-config --set /etc/glance/glance-api.conf keystone_authtoken admin_user glance</div><div class="line"># openstack-config --set /etc/glance/glance-api.conf keystone_authtoken admin_password passwd</div><div class="line"># openstack-config --set /etc/glance/glance-api.conf paste_deploy flavor keystone</div><div class="line"># openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken auth_uri http://controller:5000</div><div class="line"># openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken auth_host controller</div><div class="line"># openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken auth_port 35357</div><div class="line"># openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken auth_protocol http</div><div class="line"># openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken admin_tenant_name service</div><div class="line"># openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken admin_user glance</div><div class="line"># openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken admin_password passwd</div><div class="line"># openstack-config --set /etc/glance/glance-registry.conf paste_deploy flavor keystone</div><div class="line"># keystone service-create --name=glance --type=image --description=&quot;OpenStack Image Service&quot;</div><div class="line"># keystone endpoint-create --service-id=$(keystone service-list | awk &apos;/ image / &#123;print $2&#125;&apos;) --publicurl=http://controller:9#--internalurl=http://controller:9#--adminurl=http://controller:9292</div></pre></td></tr></table></figure>
<h3 id="启动glance服务并设置开机启动"><a href="#启动glance服务并设置开机启动" class="headerlink" title="启动glance服务并设置开机启动"></a>启动glance服务并设置开机启动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># service openstack-glance-api start</div><div class="line"># service openstack-glance-registry start</div><div class="line"># chkconfig openstack-glance-api on</div><div class="line"># chkconfig openstack-glance-registry on</div></pre></td></tr></table></figure>
<h3 id="验证glance服务"><a href="#验证glance服务" class="headerlink" title="验证glance服务"></a>验证glance服务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># wget http://download.cirros-cloud.net/0.3.2/cirros-0.3.2-x86_64-disk.img</div><div class="line"># glance image-create --name &quot;CirrOS&quot; --disk-format qcow2 --container-format bare --is-public True --progress &lt; cirros-0.3.2-x86_64-disk.img</div><div class="line"># glance image-list</div></pre></td></tr></table></figure>
<p><img src="http://or8rxwtgb.bkt.clouddn.com/glance_image_list.png" alt="glance-image-list"></p>
<h2 id="安装和配置计算服务nova"><a href="#安装和配置计算服务nova" class="headerlink" title="安装和配置计算服务nova"></a>安装和配置计算服务nova</h2><h3 id="安装nova"><a href="#安装nova" class="headerlink" title="安装nova"></a>安装nova</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># yum install openstack-nova-api openstack-nova-cert openstack-nova-conductor openstack-nova-console openstack-nova-novncproxy openstack-nova-scheduler python-novaclient</div></pre></td></tr></table></figure>
<h3 id="配置nova"><a href="#配置nova" class="headerlink" title="配置nova"></a>配置nova</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"># openstack-config --set /etc/nova/nova.conf database connection mysql://nova:passwd@controller/nova</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT rpc_backend qpid</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT qpid_hostname controller</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT my_ip controller</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT vncserver_listen controller</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT vncserver_proxyclient_address controller</div><div class="line"></div><div class="line"># mysql -uroot -p</div><div class="line">mysql&gt; CREATE DATABASE nova;</div><div class="line">mysql&gt; GRANT ALL PRIVILEGES ON nova.* TO &apos;nova&apos;@&apos;localhost&apos; \</div><div class="line">IDENTIFIED BY &apos;password&apos;;</div><div class="line">mysql&gt; GRANT ALL PRIVILEGES ON nova.* TO &apos;nova&apos;@&apos;%&apos; \</div><div class="line">IDENTIFIED BY ‘password&apos;;</div><div class="line">mysql&gt;exit</div><div class="line"></div><div class="line"># su -s /bin/sh -c &quot;nova-manage db sync&quot; nova</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT auth_strategy keystone</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_uri http://controller:5000</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_host controller</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_protocol http</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_port 35357</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken admin_user nova</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken admin_tenant_name service</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken admin_password passwd</div></pre></td></tr></table></figure>
<h3 id="创建nova用户，服务"><a href="#创建nova用户，服务" class="headerlink" title="创建nova用户，服务"></a>创建nova用户，服务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># keystone user-create --name=nova --pass=passwd --email=123456@qq.com</div><div class="line"># keystone user-role-add --user=nova --tenant=service --role=admin</div><div class="line"># keystone service-create --name=nova --type=compute --description=&quot;OpenStack Compute&quot;</div><div class="line"># keystone endpoint-create --service-id=$(keystone service-list | awk &apos;/ compute / &#123;print $2&#125;&apos;) --publicurl=http://controller:8774/v2/%\(tenant_id\)s --internalurl=http://controller:8774/v2/%\(tenant_id\)s --adminurl=http://controller:8774/v2/%\(tenant_id\)s</div></pre></td></tr></table></figure>
<h3 id="启动并设置开机启动"><a href="#启动并设置开机启动" class="headerlink" title="启动并设置开机启动"></a>启动并设置开机启动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"># service openstack-nova-api start</div><div class="line"># service openstack-nova-cert start</div><div class="line"># service openstack-nova-consoleauth start</div><div class="line"># service openstack-nova-scheduler start</div><div class="line"># service openstack-nova-conductor start</div><div class="line"># service openstack-nova-novncproxy start</div><div class="line"># chkconfig openstack-nova-api on</div><div class="line"># chkconfig openstack-nova-cert on</div><div class="line"># chkconfig openstack-nova-consoleauth on</div><div class="line"># chkconfig openstack-nova-scheduler on</div><div class="line"># chkconfig openstack-nova-conductor on</div><div class="line"># chkconfig openstack-nova-novncproxy on</div></pre></td></tr></table></figure>
<h3 id="验证nova"><a href="#验证nova" class="headerlink" title="验证nova"></a>验证nova</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># nova image-list</div></pre></td></tr></table></figure>
<p><img src="http://or8rxwtgb.bkt.clouddn.com/nova-image-list.png" alt="nova-image-list"></p>
<h2 id="配置network"><a href="#配置network" class="headerlink" title="配置network"></a>配置network</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT network_api_class nova.network.api.API</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT security_group_api nova</div><div class="line"># service openstack-nova-api restart</div><div class="line"># service openstack-nova-scheduler restart</div><div class="line"># service openstack-nova-conductor restart</div></pre></td></tr></table></figure>
<h2 id="安装和配置dashboard服务"><a href="#安装和配置dashboard服务" class="headerlink" title="安装和配置dashboard服务"></a>安装和配置dashboard服务</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># yum install memcached python-memcached mod_wsgi openstack-dashboard</div></pre></td></tr></table></figure>
<p>修改/etc/openstack-dashboard/local_settings文件中 <code>CACHES</code>， <code>ALLOWED_HOST</code>， <code>OPENSTACK_HOST</code>字段为如下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">···</div><div class="line">CACHES = &#123;</div><div class="line">    &apos;default&apos;: &#123;</div><div class="line">        &apos;BACKEND&apos; : &apos;django.core.cache.backends.memcached.MemcachedCache&apos;,</div><div class="line">        &apos;LOCATION&apos; : &apos;127.0.0.1:11211&apos;,</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">···</div><div class="line">···</div><div class="line">ALLOWED_HOSTS = [&apos;localhost&apos;, &apos;controller&apos;]</div><div class="line">···</div><div class="line">···</div><div class="line">OPENSTACK_HOST = &quot;controller&quot;</div><div class="line">···</div></pre></td></tr></table></figure></p>
<p>启动相关服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># setsebool -P httpd_can_network_connect on</div><div class="line"># service httpd start</div><div class="line"># service memcached start</div><div class="line"># chkconfig httpd on</div><div class="line"># chkconfig memcached on</div></pre></td></tr></table></figure></p>
<p>到这里， <code>controller</code>节点基本配置完毕，可以通过在浏览器中输入<code>http://controller/dashboard</code>，来验证是否配置正确。出现如下界面，说明配置正确。<br><img src="http://or8rxwtgb.bkt.clouddn.com/openstack_login_website.png" alt="openstack登录界面"></p>
<hr>
<h1 id="计算节点compute配置"><a href="#计算节点compute配置" class="headerlink" title="计算节点compute配置"></a>计算节点compute配置</h1><p>因为计算节点主要是提供资源以供控制节点利用，因此，计算节点的配置相对简单。</p>
<h2 id="安装MySQL数据库Python库"><a href="#安装MySQL数据库Python库" class="headerlink" title="安装MySQL数据库Python库"></a>安装MySQL数据库Python库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># yum install MySQL-python</div></pre></td></tr></table></figure>
<h2 id="安装和配置计算服务nova-1"><a href="#安装和配置计算服务nova-1" class="headerlink" title="安装和配置计算服务nova"></a>安装和配置计算服务nova</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"># yum install openstack-nova-compute</div><div class="line"># openstack-config --set /etc/nova/nova.conf database connection mysql://nova:passwd@controller/nova</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT auth_strategy keystone</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_uri http://controller:5000</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_host controller</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_protocol http</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_port 35357</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken admin_user nova</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken admin_tenant_name service</div><div class="line"># openstack-config --set /etc/nova/nova.conf keystone_authtoken admin_password passwd</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT rpc_backend qpid</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT qpid_hostname controller</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT my_ip compute</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT vnc_enabled True</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT vncserver_listen 0.0.0.0</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT vncserver_proxyclient_address compute</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT novncproxy_base_url http://controller:6080/vnc_auto.html</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT glance_host controller</div></pre></td></tr></table></figure>
<h3 id="启动并设置开机启动相关服务"><a href="#启动并设置开机启动相关服务" class="headerlink" title="启动并设置开机启动相关服务"></a>启动并设置开机启动相关服务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># service libvirtd start</div><div class="line"># service messagebus start</div><div class="line"># service openstack-nova-compute start</div><div class="line"># chkconfig libvirtd on</div><div class="line"># chkconfig messagebus on</div><div class="line"># chkconfig openstack-nova-compute on</div></pre></td></tr></table></figure>
<h3 id="查看系统是否支持硬件加速，决定是用KVM还是QEMU"><a href="#查看系统是否支持硬件加速，决定是用KVM还是QEMU" class="headerlink" title="查看系统是否支持硬件加速，决定是用KVM还是QEMU"></a>查看系统是否支持硬件加速，决定是用KVM还是QEMU</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># egrep -c &apos;(vmx|svm)&apos; /proc/cpuinfo</div></pre></td></tr></table></figure>
<p>如果输出为0，说明不支持硬件加速，需要输入下述命令让 <code>libvirt</code> 使用QEMU而不是KVM<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># openstack-config --set /etc/nova/nova.conf libvirt virt_type qemu</div></pre></td></tr></table></figure></p>
<p>如果你是使用vmware虚拟机创建的系统，默认是不支持硬件加速的，可以自己手动开启。在 <code>虚拟机</code> -&gt; <code>设置</code> -&gt; <code>处理器</code>中勾选 <code>虚拟化 Intel VT-x/EPT 或 AMD-V/RVI(V)</code>选项<br><img src="http://or8rxwtgb.bkt.clouddn.com/start_hardware_acceleration.png" alt="start_hardware_acceleration"></p>
<h2 id="安装和配置network"><a href="#安装和配置network" class="headerlink" title="安装和配置network"></a>安装和配置network</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"># yum install openstack-nova-network openstack-nova-api</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT network_api_class nova.network.api.API</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT security_group_api nova</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT network_manager nova.network.manager.FlatDHCPManager</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT firewall_driver nova.virt.libvirt.firewall.IptablesFirewallDriver</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT network_size 254</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT allow_same_net_traffic False</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT multi_host True</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT send_arp_for_ha True</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT share_dhcp_address True</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT force_dhcp_release True</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT flat_network_bridge br100</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT flat_interface eth1</div><div class="line"># openstack-config --set /etc/nova/nova.conf DEFAULT public_interface eth1</div></pre></td></tr></table></figure>
<h3 id="启动并设置开机启动相关服务-1"><a href="#启动并设置开机启动相关服务-1" class="headerlink" title="启动并设置开机启动相关服务"></a>启动并设置开机启动相关服务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># service openstack-nova-network start</div><div class="line"># service openstack-nova-metadata-api start</div><div class="line"># chkconfig openstack-nova-network on</div><div class="line"># chkconfig openstack-nova-metadata-api on</div></pre></td></tr></table></figure>
<hr>
<h1 id="创建实例"><a href="#创建实例" class="headerlink" title="创建实例"></a>创建实例</h1><p>以下命令在控制节点 <code>controller</code> 中进行</p>
<h2 id="创建初始网络"><a href="#创建初始网络" class="headerlink" title="创建初始网络"></a>创建初始网络</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># source admin-openrc.sh</div><div class="line"># nova network-create demo-net --bridge br#--multi-host T --fixed-range-v4 203.0.113.24/29</div><div class="line"># nova net-list</div></pre></td></tr></table></figure>
<p><code>nova net-list</code>可以查看创建的示例网卡<br><img src="http://or8rxwtgb.bkt.clouddn.com/nova_net-list.png" alt="nova-net-list"></p>
<h2 id="创建密钥对并添加到OpenStack中"><a href="#创建密钥对并添加到OpenStack中" class="headerlink" title="创建密钥对并添加到OpenStack中"></a>创建密钥对并添加到OpenStack中</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># ssh-keygen</div><div class="line"># nova keypair-add --pub-key ~/.ssh/id_rsa.pub demo-key</div><div class="line"># nova keypair-list</div></pre></td></tr></table></figure>
<p><img src="http://or8rxwtgb.bkt.clouddn.com/nova-keypair-list.png" alt="nova-keypair-list"></p>
<h2 id="创建实例-1"><a href="#创建实例-1" class="headerlink" title="创建实例"></a>创建实例</h2><p>下面命令中的<code>DEMO_NET_ID</code>用你自己创建的 <code>demo-net</code> 的ID替代<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># nova boot --flavor m1.tiny --image cirros-0.3.2-x86_64 --nic net-id=DEMO_NET_ID --security-group default --key-name demo-key demo-instance1</div></pre></td></tr></table></figure></p>
<hr>
<h1 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h1><h3 id="出现You-should-rebuild-using-libgmp-gt-5-to-avoid-timing-attack-vulnerability-警告"><a href="#出现You-should-rebuild-using-libgmp-gt-5-to-avoid-timing-attack-vulnerability-警告" class="headerlink" title="出现You should rebuild using libgmp &gt;= 5 to avoid timing attack vulnerability.警告"></a>出现You should rebuild using libgmp &gt;= 5 to avoid timing attack vulnerability.警告</h3><p><img src="http://or8rxwtgb.bkt.clouddn.com/libgmp_warning.png" alt="libgmp警告"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"># wget https://ftp.gnu.org/gnu/gmp/gmp-6.1.2.tar.bz2</div><div class="line"># tar xvjpf gmp-6.1.2.tar.bz2</div><div class="line"># cd gmp-6.1.2</div><div class="line"># ./configure</div><div class="line"># make</div><div class="line"># make check</div><div class="line"># make install</div><div class="line"># cd ..</div><div class="line"># yum install python-devel</div><div class="line"># wget https://ftp.dlitz.net/pub/dlitz/crypto/pycrypto/pycrypto-2.6.1.tar.gz</div><div class="line"># tar zxvf pycrypto-2.6.1.tar.gz</div><div class="line"># cd pycrypto-2.6.1</div><div class="line"># ./configure</div><div class="line"># python setup.py install</div></pre></td></tr></table></figure></p>
<h3 id="openstack-nova-novncproxy服务无法启动"><a href="#openstack-nova-novncproxy服务无法启动" class="headerlink" title="openstack-nova-novncproxy服务无法启动"></a>openstack-nova-novncproxy服务无法启动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># service openstack-nova-novncproxy status</div><div class="line">openstack-nova-novncproxy dead but pid file exists</div></pre></td></tr></table></figure>
<p>debug查看发现：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"># /usr/bin/nova-novncproxy --debug</div><div class="line">WARNING: no &apos;numpy&apos; module, HyBi protocol will be slower</div><div class="line">Traceback (most recent call last):</div><div class="line">  File &quot;/usr/bin/nova-novncproxy&quot;, line 10, in &lt;module&gt;</div><div class="line">    sys.exit(main())</div><div class="line">  File &quot;/usr/lib/python2.6/site-packages/nova/cmd/novncproxy.py&quot;, line 87, in main</div><div class="line">    wrap_cmd=None)</div><div class="line">  File &quot;/usr/lib/python2.6/site-packages/nova/console/websocketproxy.py&quot;, line 47, in __init__</div><div class="line">    ssl_target=None, *args, **kwargs)</div><div class="line">  File &quot;/usr/lib/python2.6/site-packages/websockify/websocketproxy.py&quot;, line 231, in __init__</div><div class="line">    websocket.WebSocketServer.__init__(self, RequestHandlerClass, *args, **kwargs)</div><div class="line">TypeError: __init__() got an unexpected keyword argument &apos;no_parent&apos;</div></pre></td></tr></table></figure></p>
<p>网上查了相关资料后了解到，这是因为 <code>python-websockify</code> 版本的问题，如果为0.6.0版本的话就会出现此错误，改为0.5.1版本即可。</p>
<p>我们之前添加了两个源 <code>epel</code> 和 <code>openstack-icehouse</code>。在 <code>epel</code> 中， <code>python-websockify</code>是0.6.0版本，而 <code>openstack-icehouse</code> 则为0.5.1版本，解决办法即为调整源的优先级，让 <code>yum</code> 优先使用 <code>openstack-icehouse</code>源即可。</p>
<p><code>openstack-icehouse</code> 默认有了优先级98，我们只要把 <code>epel</code>的优先级设置为99 即可。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># vim /etc/yum.repo.d/epel.repo</div><div class="line">[epel]</div><div class="line">···</div><div class="line">priority=99</div></pre></td></tr></table></figure></p>
<p>如果你已经安装了 <code>python-websockify0.6.0</code>，可先删除 再进行安装即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># yum remove python-websockify0.6.0</div><div class="line"># yum install openstack-nova-novncproxy openstack-nova-console</div></pre></td></tr></table></figure></p>
<h3 id="打开OpenStack控制台出错，显示Failed-to-connect-to-server-code-1006"><a href="#打开OpenStack控制台出错，显示Failed-to-connect-to-server-code-1006" class="headerlink" title="打开OpenStack控制台出错，显示Failed to connect to server(code: 1006)"></a>打开OpenStack控制台出错，显示Failed to connect to server(code: 1006)</h3><p>可能是iptables规则给拦截了，可以关闭iptables后再次尝试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># service iptables stop</div></pre></td></tr></table></figure></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/centos6-5/" rel="tag"><i class="fa fa-tag"></i> centos6.5</a>
          
            <a href="/tags/openstack/" rel="tag"><i class="fa fa-tag"></i> openstack</a>
          
            <a href="/tags/icehouse/" rel="tag"><i class="fa fa-tag"></i> icehouse</a>
          
            <a href="/tags/云计算/" rel="tag"><i class="fa fa-tag"></i> 云计算</a>
          
            <a href="/tags/linux/" rel="tag"><i class="fa fa-tag"></i> linux</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/06/13/Hexo+NexT主题配置记录/" rel="next" title="Hexo+NexT主题配置记录">
                <i class="fa fa-chevron-left"></i> Hexo+NexT主题配置记录
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/07/15/Ubuntu16-04-2安装后优化/" rel="prev" title="Ubuntu16.04.2安装后优化">
                Ubuntu16.04.2安装后优化 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/little_panda.jpg"
               alt="Fbambooz" />
          <p class="site-author-name" itemprop="name">Fbambooz</p>
           
              <p class="site-description motion-element" itemprop="description">Sometimes ever, sometimes never.</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/fbambooz" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:fbambooz@gmail.com" target="_blank" title="Email">
                  
                    <i class="fa fa-fw fa-envelope"></i>
                  
                  Email
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank" rel="external nofollow">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#环境-amp-版本"><span class="nav-number">1.</span> <span class="nav-text">环境 & 版本</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#安装前准备"><span class="nav-number">2.</span> <span class="nav-text">安装前准备</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#关闭防火墙"><span class="nav-number">2.1.</span> <span class="nav-text">关闭防火墙</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改文件"><span class="nav-number">2.2.</span> <span class="nav-text">修改文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#修改-etc-yum-conf文件"><span class="nav-number">2.2.1.</span> <span class="nav-text">修改/etc/yum.conf文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置网络"><span class="nav-number">2.2.2.</span> <span class="nav-text">配置网络</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#添加IceHouse源"><span class="nav-number">2.3.</span> <span class="nav-text">添加IceHouse源</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装消息队列qpid"><span class="nav-number">2.4.</span> <span class="nav-text">安装消息队列qpid</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#配置qpid"><span class="nav-number">2.4.1.</span> <span class="nav-text">配置qpid</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#启动qpid并设置开机启动"><span class="nav-number">2.4.2.</span> <span class="nav-text">启动qpid并设置开机启动</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#控制节点controller配置"><span class="nav-number">3.</span> <span class="nav-text">控制节点controller配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装MySQL数据库"><span class="nav-number">3.1.</span> <span class="nav-text">安装MySQL数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#修改数据库配置"><span class="nav-number">3.1.1.</span> <span class="nav-text">修改数据库配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#启动mysql并设置开机启动"><span class="nav-number">3.1.2.</span> <span class="nav-text">启动mysql并设置开机启动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#初始化数据库"><span class="nav-number">3.1.3.</span> <span class="nav-text">初始化数据库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装配置身份认证组件keystone"><span class="nav-number">3.2.</span> <span class="nav-text">安装配置身份认证组件keystone</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装keystone"><span class="nav-number">3.2.1.</span> <span class="nav-text">安装keystone</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置keystone"><span class="nav-number">3.2.2.</span> <span class="nav-text">配置keystone</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建用户、租户、角色"><span class="nav-number">3.2.3.</span> <span class="nav-text">创建用户、租户、角色</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#验证keyston是否成功安装"><span class="nav-number">3.2.4.</span> <span class="nav-text">验证keyston是否成功安装</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创建-admin-openrc-sh文件"><span class="nav-number">3.2.4.1.</span> <span class="nav-text">创建 admin-openrc.sh文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#验证keystone"><span class="nav-number">3.2.4.2.</span> <span class="nav-text">验证keystone</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装和配置镜像组件glance"><span class="nav-number">3.3.</span> <span class="nav-text">安装和配置镜像组件glance</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装glance"><span class="nav-number">3.3.1.</span> <span class="nav-text">安装glance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置glance数据库"><span class="nav-number">3.3.2.</span> <span class="nav-text">配置glance数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建glance用户"><span class="nav-number">3.3.3.</span> <span class="nav-text">创建glance用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置glance"><span class="nav-number">3.3.4.</span> <span class="nav-text">配置glance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#启动glance服务并设置开机启动"><span class="nav-number">3.3.5.</span> <span class="nav-text">启动glance服务并设置开机启动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#验证glance服务"><span class="nav-number">3.3.6.</span> <span class="nav-text">验证glance服务</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装和配置计算服务nova"><span class="nav-number">3.4.</span> <span class="nav-text">安装和配置计算服务nova</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装nova"><span class="nav-number">3.4.1.</span> <span class="nav-text">安装nova</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置nova"><span class="nav-number">3.4.2.</span> <span class="nav-text">配置nova</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建nova用户，服务"><span class="nav-number">3.4.3.</span> <span class="nav-text">创建nova用户，服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#启动并设置开机启动"><span class="nav-number">3.4.4.</span> <span class="nav-text">启动并设置开机启动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#验证nova"><span class="nav-number">3.4.5.</span> <span class="nav-text">验证nova</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配置network"><span class="nav-number">3.5.</span> <span class="nav-text">配置network</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装和配置dashboard服务"><span class="nav-number">3.6.</span> <span class="nav-text">安装和配置dashboard服务</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#计算节点compute配置"><span class="nav-number">4.</span> <span class="nav-text">计算节点compute配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装MySQL数据库Python库"><span class="nav-number">4.1.</span> <span class="nav-text">安装MySQL数据库Python库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装和配置计算服务nova-1"><span class="nav-number">4.2.</span> <span class="nav-text">安装和配置计算服务nova</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#启动并设置开机启动相关服务"><span class="nav-number">4.2.1.</span> <span class="nav-text">启动并设置开机启动相关服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看系统是否支持硬件加速，决定是用KVM还是QEMU"><span class="nav-number">4.2.2.</span> <span class="nav-text">查看系统是否支持硬件加速，决定是用KVM还是QEMU</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装和配置network"><span class="nav-number">4.3.</span> <span class="nav-text">安装和配置network</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#启动并设置开机启动相关服务-1"><span class="nav-number">4.3.1.</span> <span class="nav-text">启动并设置开机启动相关服务</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#创建实例"><span class="nav-number">5.</span> <span class="nav-text">创建实例</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#创建初始网络"><span class="nav-number">5.1.</span> <span class="nav-text">创建初始网络</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建密钥对并添加到OpenStack中"><span class="nav-number">5.2.</span> <span class="nav-text">创建密钥对并添加到OpenStack中</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建实例-1"><span class="nav-number">5.3.</span> <span class="nav-text">创建实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#问题解决"><span class="nav-number">6.</span> <span class="nav-text">问题解决</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#出现You-should-rebuild-using-libgmp-gt-5-to-avoid-timing-attack-vulnerability-警告"><span class="nav-number">6.0.1.</span> <span class="nav-text">出现You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.警告</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#openstack-nova-novncproxy服务无法启动"><span class="nav-number">6.0.2.</span> <span class="nav-text">openstack-nova-novncproxy服务无法启动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#打开OpenStack控制台出错，显示Failed-to-connect-to-server-code-1006"><span class="nav-number">6.0.3.</span> <span class="nav-text">打开OpenStack控制台出错，显示Failed to connect to server(code: 1006)</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Fbambooz</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io" rel="external nofollow">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">
    NexT.Pisces
  </a>
</div>


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("uCBo8gx3JhS2BXXmko4KlYCV-gzGzoHsz", "vKoefqegLsVPiaPm1rpgc5Uz");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  

</body>
</html>
